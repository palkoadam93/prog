<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>20. feladat</title>
  </head>
  <body>
    <h1>20. feladat - Az ALL, ANY és EXISTS predikátum összehasonlítása</h1>

    

    <h3>1. Keressük ki azokat a megrendelőket, akiknek minden megrendelése 10000 Ft felett volt!</h3>
    <p>SELECT DISTINCT partner_kód FROM rendelésfej; => PARTNER{partner_kód}</p>
    
    <p>1. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE 10000&lt;ALL (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám);</p>

    <p>2. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE NOT EXISTS (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám HAVING SUM(darab*ár)&lt;=10000);</p>

    <p>3. megoldás</p>
    <p>SELECT rendelésfej.rend_szám, SUM(darab*ár) AS rend_ár, MAX(partner_kód) AS kód FROM rendelésfej, rendelés, termék WHERE rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám; => REND_ÁR{rend_szám, rend_ár, kód}</p>
    <p>SELECT kód, MIN(rend_ár) FROM rend_ár GROUP BY kód HAVING MIN(rend_ár)>10000;</p>
    
    <h3>2. Keressük ki azokat a megrendelőket, akiknek van olyan megrendelésük, amelyik 10000 Ft vagy az alatt volt!</h3>

    <p>1. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE EXISTS (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám HAVING SUM(darab*ár)&lt;=10000);</p>

    <p>2. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE 10000>=ANY (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám);</p>

    <p>3. megoldás</p>
    <p>SELECT kód, MIN(rend_ár) FROM rend_ár GROUP BY kód HAVING MIN(rend_ár)&lt;=10000;</p>
    
    <h3>3. Keressük ki azokat a megrendelőket, akiknek minden megrendelése kisebb vagy egyenlő mint 10000 Ft!</h3>
    <p>1. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE 10000>=ALL (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám);</p>

    <p>2. megoldás</p>
    <p>SELECT partner_kód FROM partner WHERE NOT 10000&lt;ALL (SELECT SUM(darab*ár) FROM rendelésfej, rendelés, termék WHERE rendelésfej.partner_kód = partner.partner_kód AND rendelésfej.rend_szám = rendelés.rend_szám AND rendelés.kód = termék.kód GROUP BY rendelésfej.rend_szám);</p>

    <p>3. megoldás</p>
    <p>SELECT kód, MAX(rend_ár) FROM rend_ár GROUP BY kód HAVING MAX(rend_ár)&lt;10000;</p>
  </body>
</html>