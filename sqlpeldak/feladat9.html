<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>9. feladat</title>
  </head>
  <body>
    <h1>9. feladat - Halmazműveletek</h1>
    
    <h3>1. Keressük meg azoknak a termékeknek a nevét és kódját, amelyeket jelenleg meg lehet rendelni!</h3>
    <p>SELECT név, kód FROM termék;</p>
    
    <h3>2. Írassuk ki azoknak a termékeknek a kódját, amelyeket valamikor már megrendeltek! A termék nevét is ki tudjuk mellé írni?</h3>
    <p>SELECT kód FROM rendelés;</p>
    <p>SELECT DISTINCT kód FROM rendelés;</p>
    
    <h3>3. Készítsünk egy olyan listát, amely tartalmazza azoknak a termékeknek a kódját, amelyeket valamikor már megrendeltek és azoknak a kódját is, amelyeket jelenleg megrendelhetnek!</h3>
    <p>SELECT kód FROM rendelés UNION SELECT kód FROM termék;</p>
    <p>SELECT DISTINCT kód FROM rendelés UNION ALL SELECT kód FROM termék ORDER BY rendelés.kód;</p>
    
    <h3>4. Készítsünk egy olyan listát, amely tartalmazza azoknak a termékeknek a kódját, amelyeket jelenleg megrendelhetnek, de még nem rendeltek meg!</h3>
    <p>SELECT kód FROM termék WHERE kód NOT IN (SELECT kód FROM rendelés);</p>
    <p>SELECT kód FROM termék MINUS SELECT kód FROM rendelés;</p>
    
    <h3>5. Készítsünk egy olyan listát, amely tartalmazza azoknak a termékeknek a kódját, amelyeket már nem rendelhetnek meg, de valamikor rendeltek!</h3>
    <p>SELECT DISTINCT kód FROM rendelés WHERE kód NOT IN (SELECT kód FROM termék);</p>
    
    <h3>6. Készítsünk egy olyan listát, amely csak azoknak a termékeknek a kódját tartalmazza, amelyeket valamikor már megrendeltek és jelenleg is megrendelhetnek!</h3>
    <p>SELECT kód FROM termék WHERE kód IN (SELECT kód FROM rendelés);</p>
    <p>SELECT DISTINCT kód FROM rendelés WHERE kód IN (SELECT kód FROM termék);</p>
    <p>SELECT kód FROM termék INTERSECT SELECT kód FROM rendelés;</p>
    
    <h3>7. Készítsünk egy olyan listát, amely csak azoknak a termékeknek a kódját és nevét tartalmazza, amelyeket valamikor már megrendeltek és jelenleg is megrendelhetnek!</h3>
    <p>SELECT kód, név FROM termék WHERE kód IN (SELECT kód FROM rendelés);</p>
    
    <h3>8. Készítsünk egy olyan listát, amely csak azoknak a termékeknek a kódját és a belőlük megrendelt darabszámot tartalmazza, amelyeket valamikor már megrendeltek és jelenleg is megrendelhetnek!</h3>
    <p>SELECT kód, SUM(darab) FROM rendelés WHERE kód IN (SELECT kód FROM termék) GROUP BY kód;</p>
    
    <h3>9. Készítsünk egy olyan listát, amely csak azoknak a termékeknek a kódját, nevét és a belőlük megrendelt darabszámot tartalmazza, amelyeket valamikor már megrendeltek és jelenleg is megrendelhetnek!</h3>
    <p>SELECT termék.kód, név, SUM(darab) FROM termék, rendelés WHERE termék.kód=rendelés.kód GROUP BY termék.kód, név;</p>
  </body>
</html>